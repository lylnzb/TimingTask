<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="Content-Type" content="text/html"; charset="utf-8" />
    <title>栏目管理</title>
    <link rel="stylesheet" href="../treetable-lay/demo/layui/css/layui.css">
    <link href="../css/table.css" rel="stylesheet" type="text/css" />
    <link href="../css/animate.css" rel="stylesheet"/>
    <link href="../css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="../css/font-awesome.min.css" rel="stylesheet"/>
    <link href="../css/ry-ui.css" rel="stylesheet"/>
    <style>
        .layui-table-fixed.layui-table-fixed-r .layui-table-body tr{background-color: white}
        .table-striped {height: 95%;}
    </style>
</head>
<body style="background-color: #ecf0f5;font-family: 微软雅黑;color: #475059;min-width: 1000px;overflow: auto">
<div class="container-div">
    <div class="row">
        <div class="col-sm-12 select-table table-striped">
            <div class="btn-group hidden-xs" id="toolbar" role="group" style="margin-top: 10px">
                <a class="btn btn-success" id="addColumn" onclick="addColumn()"><i class="fa fa-plus"></i> 新增栏目</a>
            </div>
            <table id="demoTreeTb" class="layui-hide" lay-filter="tableEvent" style="margin: 0 auto"></table>
        </div>
    </div>
</div>

<!-- 表格操作列 -->
<div id="tbBar" style="display:none;">
    <a class="btn btn-success btn-xs" lay-event="edit"><i class="fa fa-edit"></i> 编辑</a>
    <a class="btn btn-primary btn-xs" lay-event="reset"><i class="fa fa-remove"></i> 删除</a>
</div>

<script type="text/html" id="valId">
    <span class='badge badge-primary' style="margin-top: 5px;">{{ d.valid == 1 ? '正常' : '停用'}}</span>
</script>

<script type="text/javascript" src="../js/jquery/jQuery-2.2.0.min.js"></script>
<script type="text/javascript" src="../js/bstable/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../js/bstable/js/bootstrap-table.js"></script>
<script type="text/javascript" src="../js/bstable/js/bootstrap-table-zh-CN.min.js"></script>
<script src="../treetable-lay/demo/layui/layui.js"></script>
<script type="text/javascript" src="/common/util.js"></script>
<script>
    var insTb = "";

    layui.config({
        base: '../treetable-lay/'
    }).use(['layer', 'util', 'treeTable'], function () {
        var $ = layui.jquery;
        var layer = layui.layer;
        var util = layui.util;
        var treeTable = layui.treeTable;

        // 渲染表格
        insTb = treeTable.render({
            elem: '#demoTreeTb',
            url: 'data.json',
            //toolbar: 'default',
            height: 'full-70',
            skin:'nob',// 无边框风格
            tree: {
                iconIndex: 2,
                isPidData: true,
                idName: 'authorityId',
                pidName: 'parentId'
            },
            defaultToolbar: ['filter', 'print', 'exports', {
                title: '提示',
                layEvent: 'LAYTABLE_TIPS',
                icon: 'layui-icon-tips'
            }],
            cols: [[
                {type: 'checkbox'},
                {title: '序号', type: 'numbers', width: '10%'},
                {title: '栏目名称', field: 'authorityName', align: 'center', minWidth: 165},
                {title: '栏目图标', align: 'center', hide: true, templet: '<p><i class="layui-icon {{d.menuIcon}}"></i></p>'},
                {title: '栏目地址', field: 'menuUrl', align: 'center'},
                {title: '是否终极栏目', field: 'authority', align: 'center'},
                {title: '是否隐藏栏目', align: 'center', templet: function (d) {return util.toDateString(d.createTime);}},
                {title: '操作', align: 'center', toolbar: '#tbBar', width: '30%'}
            ]],
            done: function () {
                $('th').css({ 'color': 'black', 'font-weight': 'bold'})//用于设置表头的样式，th即代表表头
                $(".layui-table-box").css("border-width","0px");
                $(".layui-table-header tr").css("height","25px");
                $(".layui-table-header tr span").css("color","#666666");
                $(".layui-table-body tr").css("height","25px");
                $(".layui-form-checkbox").css("style","margin-top: 5px;");
            }
        });

        // 工具列点击事件
        treeTable.on('tool(demoTreeTb)', function (obj) {
            var event = obj.event;
            if (event === 'del') {
                layer.msg('删除成功');
                obj.del();
            } else if (event === 'edit') {
                layer.msg('修改成功');
                obj.update({authorityName: '新的名称'});
            }
        });

    });

    function addColumn(){
        top.layer.open({
            type: 2,
            title: '添加栏目',
            shadeClose: true,
            shade: 0.5,
            closeBtn:1,
            area: ['780px', '620px'],
            content: '../admin/column/addOrEditColumn.html?type=add',
            end: function () {//层消失回调
                refresh();
            }
        });
    }

    function refresh(){
        insTb.refresh();
    }
</script>
</body>
</html>